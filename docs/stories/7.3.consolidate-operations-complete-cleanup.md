# Story 7.3: Consolidate Operations and Complete Cleanup

## Status
Approved

## Story
**As a** DevOps engineer,
**I want** concise operational documentation,
**so that** I can maintain BorgStack without reading hundreds of pages.

## Acceptance Criteria
1. TROUBLESHOOTING.md (100-150 lines) covers 10 most common BorgStack problems
2. docs/integrations.md (150-200 lines) explains how BorgStack services integrate with each other
3. docs/maintenance.md (100-150 lines) has concise checklists for backup, updates, basic security
4. docs/ directory contains user-facing files (services.md, integrations.md, maintenance.md) plus protected development files
5. All internal links updated and functional
6. Total user-facing documentation < 1,500 lines verified
7. Old files deleted: docs/04-integrations/, docs/05-09, docs/POST_MVP_MULTI_TENANT_ARCHITECTURE.md
8. PROTECTED files confirmed untouched: docs/brief.md, docs/prd.md, docs/architecture.md, docs/prd/, docs/architecture/, docs/qa/, docs/stories/

## Tasks / Subtasks

- [ ] **Task 0: Review Current Operational Documentation State** (AC: 1, 2, 3, 7)
  - [ ] Count files to be deleted (6 individual files + 1 directory with 7 files = 13 files total)
  - [ ] Count total lines to be deleted (~13,459 lines from preliminary check)
  - [ ] Read docs/05-solucao-de-problemas.md to extract 10 most common BorgStack problems
  - [ ] Read docs/04-integrations/ directory (7 files) to understand current integration documentation
  - [ ] Read docs/06-manutencao.md to extract backup, update, and security checklists
  - [ ] Read docs/07-seguranca.md and docs/08-desempenho.md to identify content for maintenance.md
  - [ ] Read docs/09-workflows-exemplo.md to extract integration patterns for docs/integrations.md
  - [ ] Document content mapping strategy: which sections from old files go into which new files
  - [ ] Verify docs/POST_MVP_MULTI_TENANT_ARCHITECTURE.md can be safely deleted (post-MVP content not needed for user docs)

- [ ] **Task 1: Create TROUBLESHOOTING.md** (AC: 1, 7)
  - [ ] **Section 1: Introduction (5-10 lines)**
    - [ ] Brief explanation of troubleshooting approach
    - [ ] Reference to docker compose logs for debugging
    - [ ] Link to official Docker Compose troubleshooting documentation
  - [ ] **Section 2: Top 10 Common BorgStack Problems (70-100 lines)**
    - [ ] **Problem 1**: Docker Compose services fail to start (healthcheck failures)
      - Symptom, Cause, Solution with exact commands
    - [ ] **Problem 2**: SSL certificate generation fails (Caddy Let's Encrypt)
      - Symptom, Cause, Solution with Caddyfile verification
    - [ ] **Problem 3**: Database connection refused (PostgreSQL not ready)
      - Symptom, Cause, Solution with depends_on verification
    - [ ] **Problem 4**: Out of memory errors (OOM killer)
      - Symptom, Cause, Solution with docker stats and memory limits
    - [ ] **Problem 5**: Slow performance / high CPU usage
      - Symptom, Cause, Solution with resource monitoring
    - [ ] **Problem 6**: Volume permission errors
      - Symptom, Cause, Solution with chmod/chown commands
    - [ ] **Problem 7**: Port conflicts (address already in use)
      - Symptom, Cause, Solution with netstat/lsof
    - [ ] **Problem 8**: Backup failures (Duplicati errors)
      - Symptom, Cause, Solution with backup verification
    - [ ] **Problem 9**: Service-specific crashes (n8n, Chatwoot, etc.)
      - Symptom, Cause, Solution with service logs analysis
    - [ ] **Problem 10**: Update/migration failures
      - Symptom, Cause, Solution with rollback procedure
  - [ ] **Section 3: Getting Help (10-15 lines)**
    - [ ] Link to GitHub issues
    - [ ] Community support channels
    - [ ] How to collect diagnostic information (docker compose logs, docker stats, system info)
  - [ ] **Validation:**
    - [ ] Total lines: 100-150
    - [ ] All 10 problems have Symptom, Cause, Solution
    - [ ] All commands tested and functional
    - [ ] Links to official documentation included

- [ ] **Task 2: Create docs/integrations.md** (AC: 2, 7)
  - [ ] **Section 1: Integration Overview (15-20 lines)**
    - [ ] Explanation of n8n as central integration hub
    - [ ] HTTP/webhook integration pattern (no direct service-to-service calls)
    - [ ] Shared infrastructure (PostgreSQL, Redis, SeaweedFS)
  - [ ] **Section 2: Core Integration Patterns (60-80 lines)**
    - [ ] **Pattern 1: Evolution API → n8n → Chatwoot** (WhatsApp messages flow)
      - Webhook configuration, n8n workflow template reference, Chatwoot inbox setup
    - [ ] **Pattern 2: Directus → n8n → FileFlows** (Media processing automation)
      - Directus file upload hooks, n8n workflow for FileFlows trigger, SeaweedFS storage integration
    - [ ] **Pattern 3: n8n → External APIs** (Third-party integrations)
      - Credential management, HTTP request nodes, error handling
    - [ ] **Pattern 4: Database Sharing** (PostgreSQL multi-database setup)
      - Separate databases per service (n8n_db, chatwoot_db, directus_db, evolution_db)
      - Connection pooling and isolation
    - [ ] **Pattern 5: Cache Sharing** (Redis across services)
      - Session management (n8n, Chatwoot, Lowcoder, Directus)
      - Cache configuration and TTL policies
    - [ ] **Pattern 6: Object Storage** (SeaweedFS S3 compatibility)
      - S3 API usage from Directus and FileFlows
      - Bucket configuration and access control
  - [ ] **Section 3: Example Integration Workflows (40-60 lines)**
    - [ ] **Example 1**: Automated WhatsApp customer support flow
      - Step-by-step: WhatsApp message → Evolution API → n8n workflow → Chatwoot ticket creation
    - [ ] **Example 2**: Media processing pipeline
      - Step-by-step: Directus upload → n8n trigger → FileFlows processing → result notification
    - [ ] **Example 3**: Custom application with Lowcoder
      - Connect Lowcoder to PostgreSQL databases, build forms and dashboards
  - [ ] **Section 4: Integration Best Practices (20-30 lines)**
    - [ ] Use webhooks over polling for efficiency
    - [ ] Implement error handling and retries in n8n
    - [ ] Monitor integration performance with logs
    - [ ] Security considerations (API keys, CORS, rate limiting)
  - [ ] **Validation:**
    - [ ] Total lines: 150-200
    - [ ] All 6 integration patterns documented
    - [ ] 3 example workflows with step-by-step instructions
    - [ ] Links to relevant service documentation (from docs/services.md)
    - [ ] Best practices section included

- [ ] **Task 3: Create docs/maintenance.md** (AC: 3, 7)
  - [ ] **Section 1: Backup Checklist (30-40 lines)**
    - [ ] **Daily automated backups** (Duplicati configuration)
      - Verify backup job running (docker compose logs duplicati)
      - Check backup destination accessible
      - Monitor backup success/failure notifications
    - [ ] **Weekly backup verification**
      - Test restore of one database to verify backup integrity
      - Verify backup file sizes (should not be 0 bytes)
      - Check backup retention policy (keep last 30 days)
    - [ ] **Monthly backup testing**
      - Full restore test to staging environment
      - Document restore time benchmarks
    - [ ] **Critical files to backup**
      - PostgreSQL databases (n8n_db, chatwoot_db, directus_db, evolution_db)
      - MongoDB database (lowcoder)
      - Redis data
      - Docker volumes (borgstack_*)
      - Configuration files (.env, config/)
  - [ ] **Section 2: Update Checklist (35-45 lines)**
    - [ ] **Pre-update preparation**
      - Run backup: ./scripts/backup-now.sh
      - Review changelog for breaking changes
      - Test update in staging environment first
      - Schedule maintenance window (notify users)
    - [ ] **Update procedure**
      - Pull new images: docker compose pull
      - Stop services: docker compose down
      - Update docker-compose.yml with new version pins
      - Start services: docker compose up -d
      - Verify health checks: docker compose ps
    - [ ] **Post-update validation**
      - Check all services healthy: docker compose ps
      - Verify critical workflows still functional
      - Review logs for errors: docker compose logs --tail=100
      - Monitor performance for 24 hours
    - [ ] **Rollback procedure (if update fails)**
      - Stop services: docker compose down
      - Restore docker-compose.yml from backup
      - Pull old images: docker compose pull
      - Start services: docker compose up -d
      - Restore database from backup if needed
  - [ ] **Section 3: Security Checklist (25-35 lines)**
    - [ ] **Initial deployment security**
      - Change all default passwords in .env
      - Generate strong encryption keys (N8N_ENCRYPTION_KEY, DUPLICATI_PASSPHRASE)
      - Configure firewall (ufw allow 80,443; deny all other ports)
      - Enable automatic security updates (unattended-upgrades)
    - [ ] **Monthly security review**
      - Review user access (n8n, Chatwoot, Directus admin accounts)
      - Check for available security updates
      - Review firewall rules: sudo ufw status
      - Audit docker compose logs for suspicious activity
    - [ ] **Quarterly security updates**
      - Update all Docker images to latest patch versions
      - Review SSL certificate expiration (Caddy auto-renews)
      - Test backup restoration procedure
      - Review and rotate API keys/secrets
  - [ ] **Validation:**
    - [ ] Total lines: 100-150
    - [ ] 3 sections: Backup, Update, Security
    - [ ] All checklists actionable and testable
    - [ ] References to scripts (backup-now.sh, healthcheck.sh if they exist)
    - [ ] Commands tested and functional

- [ ] **Task 4: Delete Old Operational Documentation** (AC: 7, 8)
  - [ ] **Pre-deletion verification:**
    - [ ] Confirm new TROUBLESHOOTING.md created and validated
    - [ ] Confirm new docs/integrations.md created and validated
    - [ ] Confirm new docs/maintenance.md created and validated
    - [ ] Double-check protected files list (same as Story 7.1 and 7.2):
      - [ ] docs/brief.md (PROTECTED - do not touch)
      - [ ] docs/prd.md (PROTECTED - do not touch)
      - [ ] docs/architecture.md (PROTECTED - do not touch)
      - [ ] docs/prd/ directory (PROTECTED - do not touch)
      - [ ] docs/architecture/ directory (PROTECTED - do not touch)
      - [ ] docs/qa/ directory (PROTECTED - do not touch)
      - [ ] docs/stories/ directory (PROTECTED - do not touch)
      - [ ] CLAUDE.md (PROTECTED - do not touch)
      - [ ] CONTRIBUTING.md (PROTECTED - do not touch)
      - [ ] LICENSE (PROTECTED - do not touch)
  - [ ] **Execute deletions:**
    - [ ] Delete docs/05-solucao-de-problemas.md
    - [ ] Delete docs/06-manutencao.md
    - [ ] Delete docs/07-seguranca.md
    - [ ] Delete docs/08-desempenho.md
    - [ ] Delete docs/09-workflows-exemplo.md
    - [ ] Delete docs/POST_MVP_MULTI_TENANT_ARCHITECTURE.md
    - [ ] Delete entire docs/04-integrations/ directory (7 files)
  - [ ] **Post-deletion verification:**
    - [ ] Verify protected files still exist and unchanged
    - [ ] Run git status to confirm only intended files deleted
    - [ ] Verify no broken links in remaining documentation

- [ ] **Task 5: Update Internal Links** (AC: 5)
  - [ ] **Update links in README.md** (created in Story 7.1)
    - [ ] Update references to old docs/05-solucao-de-problemas.md → new TROUBLESHOOTING.md
    - [ ] Update references to old docs/04-integrations/ → new docs/integrations.md
    - [ ] Update references to old docs/06-manutencao.md → new docs/maintenance.md
  - [ ] **Update links in INSTALL.md** (created in Story 7.1)
    - [ ] Update troubleshooting references to point to TROUBLESHOOTING.md
  - [ ] **Update links in CONFIGURATION.md** (created in Story 7.2)
    - [ ] Update any references to old operational docs (if any)
  - [ ] **Update links in docs/services.md** (created in Story 7.2)
    - [ ] Update integration references to docs/integrations.md
    - [ ] Update maintenance references to docs/maintenance.md
  - [ ] **Verify all markdown links functional:**
    - [ ] Run markdown link checker on TROUBLESHOOTING.md
    - [ ] Run markdown link checker on docs/integrations.md
    - [ ] Run markdown link checker on docs/maintenance.md
    - [ ] Verify all cross-references between new documentation files work

- [ ] **Task 6: Verify Total Documentation Reduction** (AC: 6, 7)
  - [ ] **Count user-facing documentation lines:**
    - [ ] README.md (created in 7.1)
    - [ ] INSTALL.md (created in 7.1)
    - [ ] CONFIGURATION.md (created in 7.2)
    - [ ] TROUBLESHOOTING.md (created in this story)
    - [ ] docs/services.md (created in 7.2)
    - [ ] docs/integrations.md (created in this story)
    - [ ] docs/maintenance.md (created in this story)
    - [ ] **Total must be < 1,500 lines**
  - [ ] **Calculate Epic 7 documentation reduction:**
    - [ ] Before Epic 7: Count lines from original docs (Stories 7.1 + 7.2 + 7.3 deletions)
    - [ ] After Epic 7: Count lines from new 6-file documentation structure
    - [ ] Calculate reduction percentage (target ~95%: ~32,000 lines → ~1,400 lines)
  - [ ] **Verify final docs/ directory structure:**
    - [ ] User-facing files: services.md, integrations.md, maintenance.md
    - [ ] Protected files: brief.md, prd.md, architecture.md
    - [ ] Protected directories: prd/, architecture/, qa/, stories/
    - [ ] No other user-facing documentation in docs/

- [ ] **Task 7: Final Quality Check** (AC: 1, 2, 3, 4, 5, 6, 7, 8)
  - [ ] **Line count validation:**
    - [ ] `wc -l TROUBLESHOOTING.md` → verify 100-150 lines
    - [ ] `wc -l docs/integrations.md` → verify 150-200 lines
    - [ ] `wc -l docs/maintenance.md` → verify 100-150 lines
    - [ ] Total user-facing docs < 1,500 lines
  - [ ] **Content validation:**
    - [ ] TROUBLESHOOTING.md covers 10 most common problems
    - [ ] docs/integrations.md explains 6 integration patterns
    - [ ] docs/maintenance.md has 3 checklists (backup, update, security)
  - [ ] **Deletion validation:**
    - [ ] Confirm 6 individual files deleted (05-09, POST_MVP)
    - [ ] Confirm entire docs/04-integrations/ directory deleted (7 files)
    - [ ] Total 13 files deleted
    - [ ] Verify protected files unchanged:
      ```bash
      ls -la docs/brief.md docs/prd.md docs/architecture.md CLAUDE.md CONTRIBUTING.md LICENSE
      ls -la docs/prd/ docs/architecture/ docs/qa/ docs/stories/
      ```
  - [ ] **Link validation:**
    - [ ] All internal links functional
    - [ ] All cross-references between documentation files work
    - [ ] No broken links after deletions
  - [ ] **Portuguese quality check:**
    - [ ] Verify Brazilian Portuguese grammar and spelling
    - [ ] Maintain consistent terminology with Stories 7.1, 7.2, 6.2-6.4
    - [ ] Natural, conversational tone
  - [ ] **Epic 7 completion validation:**
    - [ ] All 3 stories in Epic 7 complete
    - [ ] Documentation reduction target achieved (~95%: ~32,000 → ~1,400 lines)
    - [ ] 6 essential files created (README.md, INSTALL.md, CONFIGURATION.md, TROUBLESHOOTING.md, docs/services.md, docs/integrations.md, docs/maintenance.md)
    - [ ] 29 old documentation files deleted across 3 stories

## Dev Notes

### Previous Story Insights

**From Story 7.1 (Consolidate Installation Documentation):**
[Source: docs/stories/7.1.consolidate-installation-documentation.md]

- **Documentation Quality Standards:** Story 7.1 achieved 90.3% reduction (3531 → 342 lines) with excellent Brazilian Portuguese quality. Story 7.3 must maintain same natural language standards.
- **Link Validation Critical:** Story 7.1 had 2 broken links caught by QA. Story 7.3 must verify all internal links functional before completion.
- **Placeholder Search:** Story 7.1 missed Portuguese placeholders ("SEU-USERNAME"). Story 7.3 must perform comprehensive case-insensitive search for placeholders before completion.
- **Diátaxis Framework Compliance:**
  - TROUBLESHOOTING.md should be How-to Guide documentation (task-oriented problem solving)
  - docs/integrations.md should be Explanation documentation (understanding integration patterns)
  - docs/maintenance.md should be How-to Guide documentation (checklists and procedures)
- **Command Verification:** All troubleshooting commands and maintenance procedures must be tested.

**From Story 7.2 (Remove Third-Party Documentation and Consolidate Configuration):**
[Source: docs/stories/7.2.remove-third-party-documentation-consolidate-configuration.md]

- **Documentation Reduction:** Story 7.2 achieved 94.9% reduction (12,476 → 635 lines). Story 7.3 must achieve similar aggressive consolidation.
- **Link Validation Critical:** Story 7.2 had 1 broken link (FileFlows docs URL) caught by QA. Story 7.3 must verify all official documentation URLs accessible before including.
- **Line Count Flexibility:** Story 7.2 exceeded targets slightly (CONFIGURATION.md: 230 vs 100-150, docs/services.md: 405 vs 200-300) for content completeness. This was justified and accepted by QA. Story 7.3 may do the same if needed for quality.
- **Protected Files Verification:** Must verify all protected files untouched after completion (same list as Stories 7.1 and 7.2).

### Epic 7 Context

**Epic 7 Goal:** Simplify BorgStack documentation from ~32,000 lines across 29 files to ~1,400 lines in 6 essential files.
[Source: docs/prd/epic-details.md Epic 7]

**Story 7.3 Scope:**
- Consolidate 13 files (6 individual files + 1 directory with 7 files) → 3 files (TROUBLESHOOTING.md + docs/integrations.md + docs/maintenance.md)
- Reduce from ~13,459 total lines → 400-500 lines (~97% reduction for this story)
- Focus on operations only (installation covered in 7.1, configuration covered in 7.2)
- This is the FINAL story in Epic 7 - must verify total Epic 7 goals achieved

**Story 7.3 is the final story in Epic 7:** After completion, all user-facing documentation will be consolidated into 6 essential files:
1. README.md (Story 7.1)
2. INSTALL.md (Story 7.1)
3. CONFIGURATION.md (Story 7.2)
4. TROUBLESHOOTING.md (Story 7.3)
5. docs/services.md (Story 7.2)
6. docs/integrations.md (Story 7.3)
7. docs/maintenance.md (Story 7.3)

Wait, that's 7 files, not 6. Let me recount based on Epic 7 description...

Actually, looking at the AC again, the final state should have these user-facing files:
- Root: README.md, INSTALL.md, CONFIGURATION.md, TROUBLESHOOTING.md
- docs/: services.md, integrations.md, maintenance.md
- Total: 7 user-facing files

The "6 essential files" mentioned in Epic 7 may have been an approximation. The actual deliverable is 7 files with < 1,500 total lines.

**Protected Files - NEVER MODIFY OR DELETE:**
[Source: docs/prd/epic-details.md Epic 7 CRITICAL section]
- docs/brief.md
- docs/prd.md
- docs/architecture.md
- All files in: docs/prd/, docs/architecture/, docs/qa/, docs/stories/
- CLAUDE.md
- CONTRIBUTING.md
- LICENSE

### Architecture Context

**Documentation Standards:**
[Source: docs/architecture/coding-standards.md]

- **File Naming:** kebab-case.md for documentation files
- **Documentation Language:** Brazilian Portuguese for user-facing docs
- **Markdown Standards:**
  - Use GitHub-flavored markdown
  - Headers use ATX style (`#` not `===`)
  - Code blocks always have language specified
  - Links use reference style for readability

**Project Structure for Operational Documentation:**
[Source: docs/architecture/unified-project-structure.md]

```
borgstack/
├── TROUBLESHOOTING.md          # Troubleshooting guide (to be created in 7.3)
├── README.md                   # Root project overview (created in 7.1)
├── INSTALL.md                  # Installation guide (created in 7.1)
├── CONFIGURATION.md            # Configuration guide (created in 7.2)
├── CONTRIBUTING.md             # PROTECTED - do not touch
├── LICENSE                     # PROTECTED - do not touch
├── CLAUDE.md                   # PROTECTED - do not touch
└── docs/
    ├── services.md             # Service-specific guides (created in 7.2)
    ├── integrations.md         # Integration tutorials (to be created in 7.3)
    ├── maintenance.md          # Maintenance guide (to be created in 7.3)
    ├── brief.md                # PROTECTED - do not touch
    ├── prd.md                  # PROTECTED - do not touch
    ├── architecture.md         # PROTECTED - do not touch
    ├── prd/                    # PROTECTED - entire directory
    ├── architecture/           # PROTECTED - entire directory
    ├── qa/                     # PROTECTED - entire directory
    └── stories/                # PROTECTED - entire directory
```

**BorgStack Integration Patterns (for docs/integrations.md):**
[Source: docs/architecture/tech-stack.md, docs/architecture/coding-standards.md]

- **n8n as Central Hub:** n8n connects all services via HTTP/webhook patterns (no direct service-to-service calls except databases)
- **Database Sharing:** PostgreSQL shared across n8n, Chatwoot, Directus, Evolution API with separate databases per service (n8n_db, chatwoot_db, directus_db, evolution_db)
- **Cache Sharing:** Redis shared across n8n, Chatwoot, Lowcoder, Directus for session management
- **Storage Integration:** SeaweedFS provides S3-compatible storage for Directus (CMS assets) and FileFlows (media processing)
- **Network Isolation:** borgstack_internal for service-to-service communication, borgstack_external for reverse proxy connectivity

**Common BorgStack Problems (for TROUBLESHOOTING.md):**

Based on architecture and coding standards, the 10 most common problems are likely:

1. **Healthcheck Failures:** Services fail to start due to depends_on health check timeouts
   - [Source: docs/architecture/coding-standards.md#health-check-requirements]
2. **SSL Certificate Failures:** Caddy Let's Encrypt fails (DNS, firewall, rate limits)
   - [Source: docs/architecture/tech-stack.md#ssl-tls]
3. **Database Connection Refused:** PostgreSQL not ready before dependent services start
   - [Source: docs/architecture/coding-standards.md#dependency-management]
4. **Out of Memory Errors:** OOM killer terminates containers (insufficient RAM)
   - [Source: docs/architecture/testing-strategy.md#performance-baselines - 36GB RAM minimum]
5. **Slow Performance / High CPU:** Resource bottlenecks, inefficient queries
   - [Source: docs/architecture/testing-strategy.md#performance-troubleshooting-guide]
6. **Volume Permission Errors:** Docker volume ownership issues (UID/GID mismatches)
   - [Source: docs/architecture/coding-standards.md#configuration-as-code]
7. **Port Conflicts:** "address already in use" errors (80, 443, or service ports)
   - [Source: docs/architecture/tech-stack.md#network-isolation]
8. **Backup Failures:** Duplicati backup errors (destination unreachable, encryption key lost)
   - [Source: docs/architecture/tech-stack.md#backup-destination]
9. **Service-Specific Crashes:** n8n, Chatwoot, Evolution API crashes (misconfigurations, missing env vars)
   - [Source: docs/architecture/tech-stack.md#application-services]
10. **Update/Migration Failures:** Breaking changes after version updates
    - [Source: docs/architecture/coding-standards.md#backup-before-updates]

**Maintenance Checklists (for docs/maintenance.md):**
[Source: docs/architecture/coding-standards.md, docs/architecture/testing-strategy.md]

- **Backup Checklist:**
  - Daily automated backups via Duplicati
  - Weekly backup verification (test restore)
  - Monthly full restore test
  - Critical files: PostgreSQL databases, MongoDB, Redis, Docker volumes, .env, config/
- **Update Checklist:**
  - Pre-update: backup (./scripts/backup-now.sh), review changelog, test in staging
  - Update: docker compose pull, down, update docker-compose.yml, up -d, verify health
  - Post-update: check logs, monitor performance 24h
  - Rollback: restore docker-compose.yml, pull old images, restore database if needed
- **Security Checklist:**
  - Initial: change default passwords, strong encryption keys, firewall (ufw), auto-updates
  - Monthly: review user access, security updates, firewall audit, log review
  - Quarterly: update images, SSL certificate check, backup restoration test, rotate secrets

### Content Mapping Strategy

**TROUBLESHOOTING.md (100-150 lines) - How-to Guide documentation:**
1. Introduction - Brief troubleshooting approach, docker compose logs reference
2. Top 10 Problems - FROM analysis of coding-standards.md and testing-strategy.md (each problem: Symptom, Cause, Solution)
3. Getting Help - Link to GitHub issues, community support, diagnostic collection

**docs/integrations.md (150-200 lines) - Explanation documentation:**
1. Integration Overview - FROM tech-stack.md (n8n hub model)
2. Core Integration Patterns - FROM tech-stack.md and coding-standards.md (6 patterns: Evolution→n8n→Chatwoot, Directus→n8n→FileFlows, n8n→External APIs, Database Sharing, Cache Sharing, Object Storage)
3. Example Integration Workflows - FROM current docs/04-integrations/ and docs/09-workflows-exemplo.md (3 examples with step-by-step)
4. Integration Best Practices - FROM coding-standards.md and testing-strategy.md

**docs/maintenance.md (100-150 lines) - How-to Guide documentation:**
1. Backup Checklist - FROM docs/06-manutencao.md + coding-standards.md
2. Update Checklist - FROM docs/06-manutencao.md + coding-standards.md#backup-before-updates
3. Security Checklist - FROM docs/07-seguranca.md + coding-standards.md#environment-variable-security

**Content to REMOVE (old operational docs):**
- docs/05-solucao-de-problemas.md - Consolidate top 10 problems into TROUBLESHOOTING.md
- docs/04-integrations/ (7 files) - Consolidate integration patterns into docs/integrations.md
- docs/06-manutencao.md - Consolidate maintenance checklists into docs/maintenance.md
- docs/07-seguranca.md - Consolidate security checklist into docs/maintenance.md
- docs/08-desempenho.md - Performance tuning is advanced topic (link to official docs instead)
- docs/09-workflows-exemplo.md - Consolidate example workflows into docs/integrations.md
- docs/POST_MVP_MULTI_TENANT_ARCHITECTURE.md - Post-MVP content, not needed for current user docs

### Project Structure Alignment

**No Conflicts Detected:**

All file operations align with defined project structure:
[Source: docs/architecture/unified-project-structure.md]

- **Files to Create:**
  - TROUBLESHOOTING.md (root) - CREATE new
  - docs/integrations.md - CREATE new
  - docs/maintenance.md - CREATE new

- **Files to Delete:**
  - docs/05-solucao-de-problemas.md - SAFE to delete (not protected)
  - docs/06-manutencao.md - SAFE to delete (not protected)
  - docs/07-seguranca.md - SAFE to delete (not protected)
  - docs/08-desempenho.md - SAFE to delete (not protected)
  - docs/09-workflows-exemplo.md - SAFE to delete (not protected)
  - docs/POST_MVP_MULTI_TENANT_ARCHITECTURE.md - SAFE to delete (not protected)
  - docs/04-integrations/ directory (7 files) - SAFE to delete (not protected)

- **Protected Files Verification:**
  - None of the deletion targets are in the protected list
  - All deletions are user-facing documentation only
  - No architecture, PRD, QA, or story files will be touched

**Cross-References to Update:**
- README.md (created in Story 7.1) - may reference old docs/05-solucao-de-problemas.md or docs/04-integrations/
- INSTALL.md (created in Story 7.1) - may reference old troubleshooting docs
- CONFIGURATION.md (created in Story 7.2) - may reference old maintenance docs
- docs/services.md (created in Story 7.2) - may reference old integration docs

## Testing

### Test Requirements

**Documentation Testing Approach:**
[Source: docs/architecture/testing-strategy.md]

**No Unit Tests Required:**
- Documentation is not code
- Focus on manual validation and content accuracy testing
- Verify all troubleshooting commands functional
- Test all maintenance procedures

**Testing Checklist for Story 7.3:**

1. **Content Accuracy Testing:**
   - Verify all 10 troubleshooting problems have working solutions
   - Test all troubleshooting commands (docker compose logs, docker stats, etc.)
   - Verify all integration patterns documented match actual architecture
   - Test all maintenance procedures (backup, update, security checklists)

2. **Link Validation:**
   - Test all internal markdown links (README.md → TROUBLESHOOTING.md, etc.)
   - Verify all cross-references to other documentation files work
   - Ensure no broken links after deletions

3. **Line Count Validation:**
   - `wc -l TROUBLESHOOTING.md` → 100-150 lines
   - `wc -l docs/integrations.md` → 150-200 lines
   - `wc -l docs/maintenance.md` → 100-150 lines
   - Total user-facing docs < 1,500 lines

4. **Deletion Safety:**
   - Verify only intended files deleted (13 files total: 6 individual + 7 in directory)
   - Confirm all protected files unchanged
   - Run git status to verify deletions

5. **Epic 7 Completion Validation:**
   - Total documentation reduction: ~32,000 lines → ~1,400 lines (~95% reduction)
   - 6-7 essential files created across Stories 7.1, 7.2, 7.3
   - 29 old documentation files deleted across 3 stories
   - All internal links functional across new documentation structure

6. **Portuguese Quality Check:**
   - Grammar and spelling verification
   - Terminology consistency with Stories 7.1, 7.2, 6.2-6.4
   - Natural language flow (conversational, not overly formal)

**Validation Commands:**

```bash
# 1. Verify line counts for Story 7.3 files
wc -l TROUBLESHOOTING.md docs/integrations.md docs/maintenance.md
# Expected: TROUBLESHOOTING.md 100-150, docs/integrations.md 150-200, docs/maintenance.md 100-150

# 2. Verify total user-facing documentation < 1,500 lines
wc -l README.md INSTALL.md CONFIGURATION.md TROUBLESHOOTING.md docs/services.md docs/integrations.md docs/maintenance.md | tail -1
# Expected: total < 1,500 lines

# 3. Verify old files deleted
ls docs/05-solucao-de-problemas.md docs/06-manutencao.md docs/07-seguranca.md docs/08-desempenho.md docs/09-workflows-exemplo.md docs/POST_MVP_MULTI_TENANT_ARCHITECTURE.md 2>/dev/null
ls -d docs/04-integrations/ 2>/dev/null
# Expected: "No such file or directory" for all

# 4. Verify protected files exist
ls docs/brief.md docs/prd.md docs/architecture.md CLAUDE.md CONTRIBUTING.md LICENSE
ls -d docs/prd/ docs/architecture/ docs/qa/ docs/stories/
# Expected: All files/directories exist

# 5. Verify final docs/ directory structure
ls docs/
# Expected: services.md, integrations.md, maintenance.md, brief.md, prd.md, architecture.md, prd/, architecture/, qa/, stories/

# 6. Test troubleshooting commands
docker compose ps
docker compose logs --tail=100
docker stats --no-stream
# Expected: All commands functional

# 7. Test maintenance commands
docker compose pull
docker compose down
docker compose up -d
# Expected: All commands functional (test in staging environment)

# 8. Check for Portuguese placeholders
grep -ri "SEU-\|YOUR-\|CHANGE_ME\|FIXME\|TODO" TROUBLESHOOTING.md docs/integrations.md docs/maintenance.md
# Expected: Only acceptable placeholders in optional/commented sections
```

**Expected Deliverables:**
- 3 new files: TROUBLESHOOTING.md (100-150 lines), docs/integrations.md (150-200 lines), docs/maintenance.md (100-150 lines)
- 6 deleted files: docs/05-09, docs/POST_MVP
- 1 deleted directory: docs/04-integrations/ (7 files)
- Updated cross-references in README.md, INSTALL.md, CONFIGURATION.md, docs/services.md
- Total user-facing documentation < 1,500 lines
- Epic 7 complete: ~95% documentation reduction achieved

**Performance Expectations:**
- TROUBLESHOOTING.md reading time: < 10 minutes (quick problem lookup and solution)
- docs/integrations.md reading time: < 15 minutes (understand integration patterns)
- docs/maintenance.md reading time: < 10 minutes (execute checklists)
- Time to find specific troubleshooting problem: < 1 minute (clear section organization)
- Zero broken links after deletions

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-17 | 1.0 | Initial story creation for Epic 7 (Documentation Simplification) - Final story | Bob (Scrum Master) |
