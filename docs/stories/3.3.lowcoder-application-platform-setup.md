# Story 3.3: Lowcoder Application Platform Setup

## Status
Approved

## Story
**As a** business user,
**I want** Lowcoder configured as an optional application development platform,
**so that** I can build custom business applications as needed.

## Acceptance Criteria
1. Lowcoder platform deployed and accessible via Caddy
2. Database connection to PostgreSQL working for application data
3. Redis connection for session management within Lowcoder applications
4. Application development and deployment functionality working
5. Documentation for building applications with Lowcoder
6. Security best practices implemented for Lowcoder applications

## Tasks / Subtasks

### Phase 0: Preconditions Verification (Execute First)

- [ ] **Task 0: Verify Preconditions from Story 3.2** (AC: All)
  - [ ] Verify Story 3.2 completed successfully (check docs/stories/3.2.lowcoder-application-platform.md status = Done)
  - [ ] Verify config/lowcoder/README.md exists and is accessible
  - [ ] Verify tests/deployment/verify-lowcoder.sh exists from Story 3.2
  - [ ] Verify Lowcoder container running: `docker compose ps lowcoder`
  - [ ] Verify LOWCODER_ADMIN_EMAIL exists in .env
  - [ ] Verify LOWCODER_ADMIN_PASSWORD exists in .env
  - [ ] Verify LOWCODER_MONGODB_URL configured in docker-compose.yml
  - [ ] Verify LOWCODER_REDIS_URL configured in docker-compose.yml

### Phase 1: Configuration & Setup (Can Execute in Parallel)

- [ ] **Task 1: Configure Database Access Permissions** (AC: 2, 6)
  - [ ] Create SQL script: config/postgresql/create-lowcoder-readonly-users.sql
  - [ ] Document read-only user creation (lowcoder_readonly_user)
  - [ ] Configure grants for lowcoder_readonly_user on all service databases (n8n_db, chatwoot_db, directus_db, evolution_db)
  - [ ] Update .env.example with LOWCODER_READONLY_DB_PASSWORD variable
  - [ ] Update scripts/bootstrap.sh to generate LOWCODER_READONLY_DB_PASSWORD
  - [ ] Document SQL script execution options (manual via psql, or add to init-databases.sql)
  - [ ] Document connection strings for read-only access

- [ ] **Task 2: Document PostgreSQL Datasource Configuration** (AC: 2, 5)
  - [ ] Create PostgreSQL datasource configuration guide in config/lowcoder/README.md
  - [ ] Document connection parameters for accessing BorgStack PostgreSQL databases
  - [ ] Provide example datasource configuration for n8n_db, chatwoot_db, directus_db, evolution_db
  - [ ] Document security considerations (read-only access, query permissions)
  - [ ] Include troubleshooting section for connection issues

### Phase 2: Documentation & Examples (Can Execute in Parallel)

- [ ] **Task 3: Document Application Development Workflow** (AC: 4, 5)
  - [ ] Document step-by-step application creation process (7-step workflow from Dev Notes)
  - [ ] Document datasource creation process
  - [ ] Document component usage (tables, forms, charts)
  - [ ] Document query builder usage for PostgreSQL
  - [ ] Document application deployment process
  - [ ] Include screenshots or workflow diagrams

- [ ] **Task 4: Implement Security Best Practices Documentation** (AC: 6)
  - [ ] Document principle of least privilege for datasource access
  - [ ] Document secure credential storage in Lowcoder
  - [ ] Document SQL injection prevention guidelines
  - [ ] Document user permission management in Lowcoder
  - [ ] Document audit logging for application access
  - [ ] Create security checklist for application developers

- [ ] **Task 5: Create Application Templates and Examples** (AC: 4, 5)
  - [ ] Document template creation process for Customer Service Dashboard (Chatwoot data visualization)
  - [ ] Document template creation process for Workflow Analytics (n8n execution metrics)
  - [ ] Document template creation process for WhatsApp Campaign Builder (Evolution API integration)
  - [ ] Create config/lowcoder/templates/ directory with README.md
  - [ ] Document how to create templates in Lowcoder UI
  - [ ] Document template export process (JSON export from Lowcoder UI)
  - [ ] Document how to import and use templates
  - [ ] Note: Templates require manual creation in Lowcoder UI, then JSON export for sharing

- [ ] **Task 6: Create Integration Examples** (AC: 4, 5)
  - [ ] Document Lowcoder → n8n webhook integration pattern
  - [ ] Document Lowcoder → Evolution API integration (sending WhatsApp)
  - [ ] Document Lowcoder → Chatwoot integration (creating contacts/conversations)
  - [ ] Document example n8n workflow pattern: Triggered by Lowcoder form submission
  - [ ] Update config/n8n/workflows/README.md with Lowcoder integration patterns

### Phase 3: Verification (Execute After Phase 1 & 2)

- [ ] **Task 7: Verify Platform Functionality** (AC: 1, 3, 4)
  - [ ] Verify Lowcoder accessible via https://lowcoder.${DOMAIN}
  - [ ] Verify admin login working with credentials from .env
  - [ ] Test PostgreSQL datasource connection from Lowcoder UI (using lowcoder_readonly_user)
  - [ ] Test application creation and deployment
  - [ ] Test Redis session management (login/logout persistence)
  - [ ] Document verification steps in test script

- [ ] **Task 8: Create Deployment Verification Script** (AC: 1, 4)
  - [ ] Update tests/deployment/verify-lowcoder.sh with functional tests
  - [ ] Add test: Verify LOWCODER_READONLY_DB_PASSWORD in .env.example
  - [ ] Add test: Verify config/postgresql/create-lowcoder-readonly-users.sql exists
  - [ ] Add test: Verify config/lowcoder/README.md has datasource documentation
  - [ ] Add test: Verify config/lowcoder/templates/ directory exists
  - [ ] Add test: Verify docs/03-services/lowcoder.md exists
  - [ ] Make script executable with proper permissions

### Phase 4: Final Documentation (Execute After All Above)

- [ ] **Task 9: Update Main Documentation** (AC: 5)
  - [ ] Update README.md with Lowcoder usage guidance
  - [ ] Add "Building Applications with Lowcoder" section
  - [ ] Link to detailed guide in config/lowcoder/README.md
  - [ ] Add common use cases and examples
  - [ ] Update service access table with Lowcoder URL

- [ ] **Task 10: Create User Guide** (AC: 5)
  - [ ] Create comprehensive user guide: docs/03-services/lowcoder.md (Portuguese)
  - [ ] Section 1: Introduction to Lowcoder (O que é Lowcoder)
  - [ ] Section 2: First-time setup (Configuração inicial)
  - [ ] Section 3: Creating your first application (Criando seu primeiro aplicativo)
  - [ ] Section 4: Working with datasources (Trabalhando com fontes de dados)
  - [ ] Section 5: Integration examples (Exemplos de integração)
  - [ ] Section 6: Security best practices (Práticas de segurança)
  - [ ] Section 7: Troubleshooting (Solução de problemas)
  - [ ] Note: Use translation context from existing Portuguese docs (01-installation.md, 02-configuration.md)
  - [ ] Maintain consistent terminology with other service guides
  - [ ] Technical terms (PostgreSQL, Redis, Lowcoder) remain in English

## Dev Notes

### Previous Story Insights

**Key Learnings from Story 3.2 (Lowcoder Deployment):**
- Lowcoder platform successfully deployed with MongoDB (metadata) and Redis (sessions) [Source: docs/stories/3.2.lowcoder-application-platform.md]
- Platform accessible via Caddy reverse proxy at https://lowcoder.${DOMAIN}
- Admin credentials configured: LOWCODER_ADMIN_EMAIL, LOWCODER_ADMIN_PASSWORD
- Encryption keys configured: LOWCODER_ENCRYPTION_PASSWORD, LOWCODER_ENCRYPTION_SALT
- Health check configured with 60s start_period for Spring Boot + Node.js initialization
- Comprehensive setup guide created: config/lowcoder/README.md
- n8n integration pattern documented: webhook triggers from Lowcoder apps

**Story 3.2 Completed:**
- ✅ Lowcoder container running (lowcoderorg/lowcoder-ce:2.7.4)
- ✅ MongoDB connection working (LOWCODER_MONGODB_URL)
- ✅ Redis connection working (LOWCODER_REDIS_URL)
- ✅ CI validation added (.github/workflows/ci.yml)
- ✅ Test script created (tests/deployment/verify-lowcoder.sh)

**Story 3.3 Focus:**
This story is about **configuring and documenting** Lowcoder for actual application development, NOT deployment (already done in 3.2). The focus is on:
1. Configuring PostgreSQL datasource access for applications
2. Creating comprehensive documentation and examples
3. Implementing security best practices
4. Ensuring the platform is ready for business users

### Architecture Context

**Lowcoder Component Details** [Source: architecture/components.md#lowcoder-low-code-application-builder]

**Responsibility:** Optional low-code platform for building custom internal business applications.

**Key Interfaces:**
- Web UI (port 3000) exposed via Caddy
- Application runtime for deployed apps
- API query builder connecting to PostgreSQL and other services

**Dependencies:**
- MongoDB (`lowcoder` database via LOWCODER_MONGODB_URL) - Platform metadata ✅ Configured in Story 3.2
- Redis (via LOWCODER_REDIS_URL) - Session management ✅ Configured in Story 3.2
- PostgreSQL (optional, for custom applications connecting to SQL data) ⚠️ **This story configures this**

### Database Access Configuration

**PostgreSQL Databases Available for Lowcoder Applications** [Source: architecture/database-schema.md]

The following PostgreSQL databases are available on the BorgStack PostgreSQL server:
- `n8n_db` - n8n workflow data (owned by n8n_user)
- `chatwoot_db` - Chatwoot customer service data (owned by chatwoot_user)
- `directus_db` - Directus CMS content (owned by directus_user)
- `evolution_db` - Evolution API WhatsApp data (owned by evolution_user)

**Security Requirement:** Lowcoder applications should NOT use service owner accounts (n8n_user, chatwoot_user, etc.). Instead, create read-only users for safe query access.

**Read-Only User Configuration Pattern:**

```sql
-- Create read-only user for Lowcoder applications
CREATE USER lowcoder_readonly_user WITH ENCRYPTED PASSWORD '${LOWCODER_READONLY_DB_PASSWORD}';

-- Grant connection to each database
GRANT CONNECT ON DATABASE n8n_db TO lowcoder_readonly_user;
GRANT CONNECT ON DATABASE chatwoot_db TO lowcoder_readonly_user;
GRANT CONNECT ON DATABASE directus_db TO lowcoder_readonly_user;
GRANT CONNECT ON DATABASE evolution_db TO lowcoder_readonly_user;

-- Grant read-only access to all tables in public schema
\c n8n_db
GRANT USAGE ON SCHEMA public TO lowcoder_readonly_user;
GRANT SELECT ON ALL TABLES IN SCHEMA public TO lowcoder_readonly_user;
ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT SELECT ON TABLES TO lowcoder_readonly_user;

\c chatwoot_db
GRANT USAGE ON SCHEMA public TO lowcoder_readonly_user;
GRANT SELECT ON ALL TABLES IN SCHEMA public TO lowcoder_readonly_user;
ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT SELECT ON TABLES TO lowcoder_readonly_user;

\c directus_db
GRANT USAGE ON SCHEMA public TO lowcoder_readonly_user;
GRANT SELECT ON ALL TABLES IN SCHEMA public TO lowcoder_readonly_user;
ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT SELECT ON TABLES TO lowcoder_readonly_user;

\c evolution_db
GRANT USAGE ON SCHEMA public TO lowcoder_readonly_user;
GRANT SELECT ON ALL TABLES IN SCHEMA public TO lowcoder_readonly_user;
ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT SELECT ON TABLES TO lowcoder_readonly_user;
```

**Connection String Format for Lowcoder Datasource:**
```
postgresql://lowcoder_readonly_user:${LOWCODER_READONLY_DB_PASSWORD}@postgresql:5432/n8n_db
postgresql://lowcoder_readonly_user:${LOWCODER_READONLY_DB_PASSWORD}@postgresql:5432/chatwoot_db
postgresql://lowcoder_readonly_user:${LOWCODER_READONLY_DB_PASSWORD}@postgresql:5432/directus_db
postgresql://lowcoder_readonly_user:${LOWCODER_READONLY_DB_PASSWORD}@postgresql:5432/evolution_db
```

**File Location:** Create `config/postgresql/create-lowcoder-readonly-users.sql` for manual execution or automated setup.

### Database User Creation Timing

**When to Execute the SQL Script:**

The read-only user creation script (`config/postgresql/create-lowcoder-readonly-users.sql`) can be executed using one of three approaches:

**Option A: Manual Execution (Recommended for Story 3.3)**
```bash
# Copy script to PostgreSQL container and execute
docker compose cp config/postgresql/create-lowcoder-readonly-users.sql postgresql:/tmp/
docker compose exec postgresql psql -U postgres -f /tmp/create-lowcoder-readonly-users.sql
```
- **Pros:** Full control, immediate feedback, easy debugging
- **Cons:** Requires manual step after deployment
- **Use when:** Testing configuration or one-time setup

**Option B: Add to Initialization Script (Future Enhancement)**
```bash
# Append to existing config/postgresql/init-databases.sql
cat config/postgresql/create-lowcoder-readonly-users.sql >> config/postgresql/init-databases.sql
```
- **Pros:** Automatic execution on first PostgreSQL startup
- **Cons:** Only runs on initial database creation, not on existing databases
- **Use when:** Fresh deployment or complete rebuild

**Option C: Manual Post-Deployment Step (Documentation Only)**
```markdown
# Document in config/lowcoder/README.md as manual setup step
Users manually execute SQL commands via psql or pgAdmin
```
- **Pros:** Maximum flexibility, no automation needed
- **Cons:** Error-prone, requires database knowledge
- **Use when:** Advanced users or custom deployments

**Recommended Approach for This Story:** Use **Option A** for initial implementation and document all three options in `config/lowcoder/README.md`.

### Rollback Plan

If read-only user configuration causes issues, follow these rollback steps:

**Step 1: Remove Database User**
```bash
# Connect to PostgreSQL and drop user
docker compose exec postgresql psql -U postgres -c "DROP USER IF EXISTS lowcoder_readonly_user;"
```

**Step 2: Revert Environment Variables**
```bash
# Remove LOWCODER_READONLY_DB_PASSWORD from .env
sed -i '/LOWCODER_READONLY_DB_PASSWORD/d' .env

# Remove from .env.example (if added)
sed -i '/LOWCODER_READONLY_DB_PASSWORD/d' .env.example
```

**Step 3: Revert Bootstrap Script Changes**
```bash
# Remove password generation from scripts/bootstrap.sh
# Manually edit or use git to restore previous version
git checkout scripts/bootstrap.sh
```

**Step 4: Remove SQL Script**
```bash
rm -f config/postgresql/create-lowcoder-readonly-users.sql
```

**Step 5: Remove Documentation Changes**
```bash
# Revert config/lowcoder/README.md to previous version
git checkout config/lowcoder/README.md
```

**Step 6: Verify Rollback**
```bash
# Verify user removed
docker compose exec postgresql psql -U postgres -c "\du" | grep lowcoder_readonly_user
# Should return nothing

# Verify .env cleaned
grep LOWCODER_READONLY_DB_PASSWORD .env
# Should return nothing
```

**When to Use Rollback:**
- PostgreSQL connection errors after user creation
- Permission issues with read-only grants
- Conflicts with existing database users
- Need to reconfigure with different permissions

### Lowcoder Datasource Configuration

**Datasource Types in Lowcoder:** [Source: Previous story insights, Lowcoder documentation patterns]

1. **PostgreSQL Datasource:**
   - Type: PostgreSQL
   - Host: postgresql (Docker service name on borgstack_internal)
   - Port: 5432
   - Database: n8n_db / chatwoot_db / directus_db / evolution_db
   - User: lowcoder_readonly_user
   - Password: ${LOWCODER_READONLY_DB_PASSWORD}
   - SSL Mode: disable (internal network)

2. **REST API Datasource:**
   - n8n Webhooks: https://n8n.${DOMAIN}/webhook/{path}
   - Evolution API: https://evolution.${DOMAIN}/message/sendText/{instance}
   - Chatwoot API: https://chatwoot.${DOMAIN}/api/v1/{endpoint}

3. **MongoDB Datasource (if needed):**
   - MongoDB URI: mongodb://lowcoder_user:${LOWCODER_DB_PASSWORD}@mongodb:27017/lowcoder?authSource=lowcoder
   - Note: Lowcoder platform uses this for metadata; applications can also query it if needed

### Common Application Use Cases

**Use Case 1: Customer Service Dashboard** [Source: Previous story insights]
- **Goal:** Visualize Chatwoot conversations and metrics
- **Datasource:** PostgreSQL (chatwoot_db)
- **Tables:** conversations, contacts, messages, agents
- **Features:** Real-time dashboard, agent performance metrics, conversation status

**Use Case 2: Workflow Management Interface** [Source: Previous story insights]
- **Goal:** Monitor and manage n8n workflows
- **Datasource:** PostgreSQL (n8n_db)
- **Tables:** workflow_entity, execution_entity, credentials_entity
- **Features:** Workflow list, execution history, trigger workflows via n8n API

**Use Case 3: WhatsApp Campaign Builder** [Source: Previous story insights]
- **Goal:** Create and send WhatsApp campaigns
- **Datasource:** REST API (Evolution API)
- **Integration:** n8n webhook trigger for bulk message sending
- **Features:** Contact list management, message templates, campaign scheduling

**Use Case 4: CMS Admin Panel** [Source: Previous story insights]
- **Goal:** Manage Directus content
- **Datasource:** REST API (Directus GraphQL API) or PostgreSQL (directus_db)
- **Features:** CRUD operations on collections, content publishing workflow

### Security Best Practices for Lowcoder Applications

**1. Principle of Least Privilege** [Source: architecture/coding-standards.md]
- Use read-only database users (lowcoder_readonly_user) for query-only applications
- Grant minimal permissions required for each datasource
- Avoid using service owner accounts (n8n_user, chatwoot_user, etc.)

**2. SQL Injection Prevention:**
- Always use parameterized queries in Lowcoder query builder
- Never concatenate user input directly into SQL queries
- Validate and sanitize all user inputs

**3. Credential Storage:**
- Store datasource credentials securely in Lowcoder (encrypted via LOWCODER_ENCRYPTION_PASSWORD)
- Do not hardcode passwords in application queries
- Use environment variables or Lowcoder's credential management

**4. User Permission Management:**
- Configure Lowcoder user roles and permissions
- Limit access to sensitive datasources
- Implement role-based access control (RBAC) in applications

**5. Audit Logging:**
- Enable Lowcoder audit logs for user actions
- Monitor database query patterns
- Review application access logs regularly

**6. HTTPS Enforcement:**
- All Lowcoder access via HTTPS (automatic via Caddy)
- API integrations use HTTPS endpoints only
- Secure session management via Redis

### Application Development Workflow

**Step-by-Step Process for Building a Lowcoder Application:**

1. **Login to Lowcoder:**
   - Access https://lowcoder.${DOMAIN}
   - Login with admin credentials from .env (LOWCODER_ADMIN_EMAIL, LOWCODER_ADMIN_PASSWORD)
   - Change password on first login (security requirement)

2. **Create Datasource:**
   - Navigate to Datasources section
   - Click "New Datasource"
   - Select PostgreSQL type
   - Configure connection (host: postgresql, port: 5432, database: chatwoot_db, user: lowcoder_readonly_user)
   - Test connection
   - Save datasource

3. **Create Application:**
   - Navigate to Applications section
   - Click "Create New App"
   - Choose template (CRUD, Dashboard, Form) or start blank
   - Design UI with drag-and-drop components

4. **Add Queries:**
   - In query editor, create new query
   - Select datasource (PostgreSQL - chatwoot_db)
   - Write SQL query (SELECT * FROM conversations WHERE status = 'open')
   - Test query
   - Bind query results to UI components

5. **Configure Components:**
   - Bind table component to query results
   - Configure filters, sorting, pagination
   - Add charts for data visualization
   - Configure forms for user input

6. **Add Interactivity:**
   - Configure button actions (trigger queries, open modals, call webhooks)
   - Set up event handlers (onClick, onChange, onSubmit)
   - Configure navigation between pages

7. **Deploy Application:**
   - Preview application
   - Click "Publish" to deploy
   - Share application URL with users
   - Configure user access permissions

### Integration Patterns

**Pattern 1: Lowcoder → n8n Webhook Trigger** [Source: Previous story insights]
- Lowcoder form submission triggers n8n workflow
- Use API query in Lowcoder: POST https://n8n.${DOMAIN}/webhook/{workflow-path}
- n8n workflow processes form data and executes automation
- Example: Contact form in Lowcoder → n8n → Send WhatsApp via Evolution API

**Pattern 2: Lowcoder Dashboard Querying Multiple Services** [Source: Architecture context]
- Single Lowcoder dashboard queries multiple PostgreSQL databases
- Combine data from n8n_db (workflows), chatwoot_db (conversations), evolution_db (WhatsApp messages)
- Display unified view of business operations
- Real-time metrics and KPIs

**Pattern 3: Lowcoder Application Calling External APIs** [Source: Integration patterns]
- REST API datasource for Evolution API (send WhatsApp message)
- REST API datasource for Chatwoot API (create contact, conversation)
- API query builder in Lowcoder for HTTP requests
- Authentication via API tokens from .env

### File Path Standards [Source: architecture/unified-project-structure.md]

**Files to Create:**
- `config/postgresql/create-lowcoder-readonly-users.sql` - Database user creation script
- `config/lowcoder/templates/` - Application template JSON exports
- `docs/03-services/lowcoder.md` - Portuguese user guide

**Files to Modify:**
- `config/lowcoder/README.md` - Add datasource configuration and application development guide
- `.env.example` - Add LOWCODER_READONLY_DB_PASSWORD variable
- `scripts/bootstrap.sh` - Add LOWCODER_READONLY_DB_PASSWORD generation
- `tests/deployment/verify-lowcoder.sh` - Add functional verification tests
- `README.md` - Add Lowcoder usage guidance section
- `config/n8n/workflows/README.md` - Add Lowcoder integration patterns

### Environment Variables

**New Variable for Story 3.3:**

```bash
# .env.example
# Lowcoder Read-Only Database Access (for applications to query service databases)
LOWCODER_READONLY_DB_PASSWORD=  # 32-char, generated by bootstrap.sh: openssl rand -base64 32
```

**Bootstrap Script Addition:**

```bash
# scripts/bootstrap.sh
# Generate Lowcoder read-only database password
LOWCODER_READONLY_DB_PASSWORD=$(openssl rand -base64 32 | tr -d '=/+' | cut -c1-32)
echo "LOWCODER_READONLY_DB_PASSWORD=${LOWCODER_READONLY_DB_PASSWORD}" >> .env
```

### Testing

**Test File Location:** `tests/deployment/verify-lowcoder.sh` (update existing file from Story 3.2)

**Test Standards:** [Source: architecture/testing-strategy.md]
- Deployment validation focus (configuration verification)
- Functional verification (UI accessibility, datasource connectivity)
- No unit tests for pre-built Lowcoder image
- Integration testing with PostgreSQL datasource

**Testing Frameworks:**
- Bash script with exit codes (0 = pass, 1 = fail)
- curl for HTTP endpoint testing
- psql for database connection verification
- Clear PASS/FAIL output with troubleshooting hints

**Specific Testing Requirements for Story 3.3:**
1. Verify LOWCODER_READONLY_DB_PASSWORD variable in .env.example
2. Verify read-only user creation script exists (config/postgresql/create-lowcoder-readonly-users.sql)
3. Verify read-only user created in PostgreSQL (if script executed)
4. Verify read-only user has SELECT permissions on all databases
5. Verify Lowcoder UI accessible via https://lowcoder.${DOMAIN} (requires DNS/hosts file)
6. Verify PostgreSQL datasource configuration documented
7. Verify application templates exist in config/lowcoder/templates/
8. Verify Portuguese user guide exists (docs/03-services/lowcoder.md)
9. Verify security best practices documented
10. Verify integration patterns documented in config/n8n/workflows/README.md

**Note on Functional Testing:**
- Full Lowcoder UI testing requires actual deployment with DNS configuration
- Datasource connection testing requires PostgreSQL read-only user to be created
- These tests should be documented with manual verification steps
- Automated tests focus on file existence and configuration validation

### Application Templates to Create

**Template 1: Customer Service Dashboard**
- **File:** `config/lowcoder/templates/customer-service-dashboard.json`
- **Datasource:** PostgreSQL (chatwoot_db)
- **Components:** Table (conversations), Chart (conversation metrics), Filters (status, agent, date range)
- **Queries:** Open conversations, closed conversations, agent performance

**Template 2: Workflow Analytics**
- **File:** `config/lowcoder/templates/workflow-analytics.json`
- **Datasource:** PostgreSQL (n8n_db)
- **Components:** Table (workflows), Chart (execution success/failure), Timeline (recent executions)
- **Queries:** Workflow list, execution history, error logs

**Template 3: WhatsApp Campaign Builder**
- **File:** `config/lowcoder/templates/whatsapp-campaign-builder.json`
- **Datasource:** REST API (Evolution API, n8n webhook)
- **Components:** Form (campaign details), Contact list, Message template editor, Send button
- **Actions:** POST to n8n webhook with campaign data

### Documentation Structure

**config/lowcoder/README.md Additions:**
- Section 4: Configuring PostgreSQL Datasources
  - Connection parameters
  - Read-only user setup
  - Security considerations
- Section 5: Building Applications
  - Step-by-step guide
  - Component usage
  - Query builder tutorial
- Section 6: Integration Examples
  - n8n webhook integration
  - Evolution API integration
  - Chatwoot API integration
- Section 7: Security Best Practices
  - SQL injection prevention
  - Credential management
  - User permissions
- Section 8: Application Templates
  - How to import templates
  - Template descriptions
  - Customization guide

**docs/03-services/lowcoder.md (Portuguese User Guide):**
- Introdução ao Lowcoder (What is Lowcoder)
- Configuração inicial (First-time setup)
- Criando seu primeiro aplicativo (Creating first application)
- Trabalhando com fontes de dados (Working with datasources)
- Exemplos de integração (Integration examples)
- Práticas de segurança (Security best practices)
- Solução de problemas (Troubleshooting)

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-04 | 1.1 | Applied validation corrections: reorganized tasks into phases, added Task 0 for precondition verification, clarified template creation process, added database user creation timing guide, added rollback plan | Sarah (Product Owner) |
| 2025-10-04 | 1.0 | Initial story creation with comprehensive architecture context | Bob (Scrum Master) |

---

## Dev Agent Record

### Agent Model Used
(To be populated by dev agent)

### Implementation Summary
(To be populated by dev agent)

### Definition of Done Checklist
(To be populated by dev agent)

### Completion Notes
(To be populated by dev agent)

### File List
(To be populated by dev agent)

---

## QA Results

(To be populated by QA agent)
